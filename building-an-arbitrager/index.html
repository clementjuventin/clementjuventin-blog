<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.0">
<title data-rh="true">Building an Arbitrage Bot | ClÃ©ment Juventin</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://clementjuventin.github.io/clementjuventin-blog/building-an-arbitrager"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="Building an Arbitrage Bot | ClÃ©ment Juventin"><meta data-rh="true" name="description" content="I&#x27;ve been fascinated by MEV (Maximal Extractable Value) for a while now, and over the past few weeks, Iâ€™ve started building my own arbitrage bot. Itâ€™s been a challenging yet insightful journey, and Iâ€™d like to share my experience so far."><meta data-rh="true" property="og:description" content="I&#x27;ve been fascinated by MEV (Maximal Extractable Value) for a while now, and over the past few weeks, Iâ€™ve started building my own arbitrage bot. Itâ€™s been a challenging yet insightful journey, and Iâ€™d like to share my experience so far."><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2025-06-03T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://linkedin.com/in/clÃ©ment-juventin-ab81841a3/"><meta data-rh="true" property="article:tag" content="Web3,Story,Technical"><link data-rh="true" rel="icon" href="/clementjuventin-blog/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://clementjuventin.github.io/clementjuventin-blog/building-an-arbitrager"><link data-rh="true" rel="alternate" href="https://clementjuventin.github.io/clementjuventin-blog/building-an-arbitrager" hreflang="en"><link data-rh="true" rel="alternate" href="https://clementjuventin.github.io/clementjuventin-blog/building-an-arbitrager" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","@id":"https://clementjuventin.github.io/clementjuventin-blog/building-an-arbitrager","mainEntityOfPage":"https://clementjuventin.github.io/clementjuventin-blog/building-an-arbitrager","url":"https://clementjuventin.github.io/clementjuventin-blog/building-an-arbitrager","headline":"Building an Arbitrage Bot","name":"Building an Arbitrage Bot","description":"I've been fascinated by MEV (Maximal Extractable Value) for a while now, and over the past few weeks, Iâ€™ve started building my own arbitrage bot. Itâ€™s been a challenging yet insightful journey, and Iâ€™d like to share my experience so far.","datePublished":"2025-06-03T00:00:00.000Z","author":{"@type":"Person","name":"ClÃ©ment Juventin","description":"Internet traveler ðŸ¤–â€‹","url":"https://linkedin.com/in/clÃ©ment-juventin-ab81841a3/","image":"https://github.com/clementjuventin.png"},"keywords":[],"isPartOf":{"@type":"Blog","@id":"https://clementjuventin.github.io/clementjuventin-blog/","name":"Blog"}}</script><link rel="alternate" type="application/rss+xml" href="/clementjuventin-blog/rss.xml" title="ClÃ©ment Juventin RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/clementjuventin-blog/atom.xml" title="ClÃ©ment Juventin Atom Feed"><link rel="stylesheet" href="/clementjuventin-blog/assets/css/styles.025c4f56.css">
<script src="/clementjuventin-blog/assets/js/runtime~main.6a6de6ec.js" defer="defer"></script>
<script src="/clementjuventin-blog/assets/js/main.f12ff64e.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="https://github.com/clementjuventin.png"><div role="region" aria-label="Skip to main content"><a class="skipToContent_kYj5" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/clementjuventin-blog/"><b class="navbar__title text--truncate">ClÃ©ment Juventin</b></a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/clementjuventin" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_VFyZ"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_Bdbm colorModeToggle_OJqu"><button class="clean-btn toggleButton_uvTa toggleButtonDisabled_Ef_J" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_GRyc lightToggleIcon_bN1_"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_GRyc darkToggleIcon_NHiB"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_GRyc systemToggleIcon_F5ss"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_qIFn"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_asJl"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_xXWV thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_tOeK margin-bottom--md">Recent posts</div><div role="group"><h3 class="yearGroupHeading_lVDx">2025</h3><ul class="sidebarItemList_OGFZ clean-list"><li class="sidebarItem_Q7s7"><a aria-current="page" class="sidebarItemLink_DEAP sidebarItemLinkActive_lF7Q" href="/clementjuventin-blog/building-an-arbitrager">Building an Arbitrage Bot</a></li><li class="sidebarItem_Q7s7"><a class="sidebarItemLink_DEAP" href="/clementjuventin-blog/degen-to-sniper">From A Nooby Degen to a Bloodthirsty Sniper</a></li><li class="sidebarItem_Q7s7"><a class="sidebarItemLink_DEAP" href="/clementjuventin-blog/opal-technical-overview">Opal - Technical Overview</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_lVDx">2024</h3><ul class="sidebarItemList_OGFZ clean-list"><li class="sidebarItem_Q7s7"><a class="sidebarItemLink_DEAP" href="/clementjuventin-blog/contribution-to-open-source-projects-evmone">My first Open Source Contribution in C++ - EVMOne</a></li><li class="sidebarItem_Q7s7"><a class="sidebarItemLink_DEAP" href="/clementjuventin-blog/opal">Opal - Yield DApp built on top of Balancer V2</a></li></ul></div></nav></aside><main class="col col--7"><article class=""><header><h1 class="title_rsdE">Building an Arbitrage Bot</h1><div class="container_w7Ve margin-vert--md"><time datetime="2025-06-03T00:00:00.000Z">June 3, 2025</time> Â· <!-- -->12 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Tp4l"><div class="avatar margin-bottom--sm"><a class="avatar__photo-link" href="/clementjuventin-blog/authors/clementjuventin"><img class="avatar__photo authorImage_CL_O" src="https://github.com/clementjuventin.png" alt="ClÃ©ment Juventin"></a><div class="avatar__intro authorDetails_xwdW"><div class="avatar__name"><a href="/clementjuventin-blog/authors/clementjuventin"><span class="authorName_FnlL">ClÃ©ment Juventin</span></a></div><small class="authorTitle_KapK" title="Internet traveler ðŸ¤–â€‹">Internet traveler ðŸ¤–â€‹</small><div class="authorSocials_G9TQ"><a href="https://www.linkedin.com/in/clementjuventin/" target="_blank" rel="noopener noreferrer" class="authorSocialLink_GZLt" title="LinkedIn"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" preserveAspectRatio="xMidYMid" viewBox="0 0 256 256" class="authorSocialLink_GZLt"><path d="M218.123 218.127h-37.931v-59.403c0-14.165-.253-32.4-19.728-32.4-19.756 0-22.779 15.434-22.779 31.369v60.43h-37.93V95.967h36.413v16.694h.51a39.907 39.907 0 0 1 35.928-19.733c38.445 0 45.533 25.288 45.533 58.186l-.016 67.013ZM56.955 79.27c-12.157.002-22.014-9.852-22.016-22.009-.002-12.157 9.851-22.014 22.008-22.016 12.157-.003 22.014 9.851 22.016 22.008A22.013 22.013 0 0 1 56.955 79.27m18.966 138.858H37.95V95.967h37.97v122.16ZM237.033.018H18.89C8.58-.098.125 8.161-.001 18.471v219.053c.122 10.315 8.576 18.582 18.89 18.474h218.144c10.336.128 18.823-8.139 18.966-18.474V18.454c-.147-10.33-8.635-18.588-18.966-18.453" fill="#0A66C2"></path></svg></a><a href="https://github.com/clementjuventin" target="_blank" rel="noopener noreferrer" class="authorSocialLink_GZLt" title="GitHub"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 256 250" preserveAspectRatio="xMidYMid" style="--dark:#000;--light:#fff" class="authorSocialLink_GZLt githubSvg_nkVx"><path d="M128.001 0C57.317 0 0 57.307 0 128.001c0 56.554 36.676 104.535 87.535 121.46 6.397 1.185 8.746-2.777 8.746-6.158 0-3.052-.12-13.135-.174-23.83-35.61 7.742-43.124-15.103-43.124-15.103-5.823-14.795-14.213-18.73-14.213-18.73-11.613-7.944.876-7.78.876-7.78 12.853.902 19.621 13.19 19.621 13.19 11.417 19.568 29.945 13.911 37.249 10.64 1.149-8.272 4.466-13.92 8.127-17.116-28.431-3.236-58.318-14.212-58.318-63.258 0-13.975 5-25.394 13.188-34.358-1.329-3.224-5.71-16.242 1.24-33.874 0 0 10.749-3.44 35.21 13.121 10.21-2.836 21.16-4.258 32.038-4.307 10.878.049 21.837 1.47 32.066 4.307 24.431-16.56 35.165-13.12 35.165-13.12 6.967 17.63 2.584 30.65 1.255 33.873 8.207 8.964 13.173 20.383 13.173 34.358 0 49.163-29.944 59.988-58.447 63.157 4.591 3.972 8.682 11.762 8.682 23.704 0 17.126-.148 30.91-.148 35.126 0 3.407 2.304 7.398 8.792 6.14C219.37 232.5 256 184.537 256 128.002 256 57.307 198.691 0 128.001 0Zm-80.06 182.34c-.282.636-1.283.827-2.194.39-.929-.417-1.45-1.284-1.15-1.922.276-.655 1.279-.838 2.205-.399.93.418 1.46 1.293 1.139 1.931Zm6.296 5.618c-.61.566-1.804.303-2.614-.591-.837-.892-.994-2.086-.375-2.66.63-.566 1.787-.301 2.626.591.838.903 1 2.088.363 2.66Zm4.32 7.188c-.785.545-2.067.034-2.86-1.104-.784-1.138-.784-2.503.017-3.05.795-.547 2.058-.055 2.861 1.075.782 1.157.782 2.522-.019 3.08Zm7.304 8.325c-.701.774-2.196.566-3.29-.49-1.119-1.032-1.43-2.496-.726-3.27.71-.776 2.213-.558 3.315.49 1.11 1.03 1.45 2.505.701 3.27Zm9.442 2.81c-.31 1.003-1.75 1.459-3.199 1.033-1.448-.439-2.395-1.613-2.103-2.626.301-1.01 1.747-1.484 3.207-1.028 1.446.436 2.396 1.602 2.095 2.622Zm10.744 1.193c.036 1.055-1.193 1.93-2.715 1.95-1.53.034-2.769-.82-2.786-1.86 0-1.065 1.202-1.932 2.733-1.958 1.522-.03 2.768.818 2.768 1.868Zm10.555-.405c.182 1.03-.875 2.088-2.387 2.37-1.485.271-2.861-.365-3.05-1.386-.184-1.056.893-2.114 2.376-2.387 1.514-.263 2.868.356 3.061 1.403Z"></path></svg></a></div></div></div></div></div></header><div id="__blog-post-container" class="markdown"><p>I&#x27;ve been fascinated by <strong>MEV</strong> (Maximal Extractable Value) for a while now, and over the past few weeks, Iâ€™ve started building <strong>my own arbitrage bot</strong>. Itâ€™s been a challenging yet insightful journey, and Iâ€™d like to share my experience so far.</p>
<h2 class="anchor anchorWithStickyNavbar_m2y2" id="what-is-mev">What is MEV?<a href="#what-is-mev" class="hash-link" aria-label="Direct link to What is MEV?" title="Direct link to What is MEV?">â€‹</a></h2>
<p>People trade funds, people watch them trading funds, people found ways to make profits based on funds being traded.
To be honest, this is not today&#x27;s topic, and it&#x27;s a very vast field. To learn more, <a href="https://www.coingecko.com/learn/what-is-mev-maximal-extractable-value-crypto" target="_blank" rel="noopener noreferrer">this article may help you</a>.</p>
<h2 class="anchor anchorWithStickyNavbar_m2y2" id="starting-with-the-basics">Starting with the Basics<a href="#starting-with-the-basics" class="hash-link" aria-label="Direct link to Starting with the Basics" title="Direct link to Starting with the Basics">â€‹</a></h2>
<p>To begin this adventure, I decided to explore the implementation of a <strong>CowSwap solver</strong>.</p>
<p>For those unfamiliar, <a href="https://cow.fi/cow-protocol" target="_blank" rel="noopener noreferrer">CowSwap</a> is an off-chain order book where solvers <strong>compete to submit the most efficient on-chain settlement</strong>. Since all solvers use the same underlying liquidity sources, the competition lies less in speed or on-chain monitoring tricks, and more in <strong>algorithmic quality</strong> (from what I understand).</p>
<p>I figured this would be a great way to get hands-on experience with arbitrage using real-world tools, while also learning from the CowSwap ecosystem itself.</p>
<p>Unfortunately, that turned out to be a bit optimistic. The competitiveness of an arbitrage system is deeply tied to its performance â€” which means that sharing strategies often <strong>undermines profitability</strong>. So, I quickly realized that there wouldnâ€™t be much help available when it came to solving the core problems.</p>
<p>That said, I followed CowSwapâ€™s documentation closely and was able to get the full local stack up and running, including syncing with the live order book.</p>
<p>I chose to implement my solver in <strong>C++</strong> â€” for once, it wasnâ€™t overkill. I was surprised to find I was already familiar with many of the liquidity models: <strong>Uniswap V2/V3</strong>, <strong>Balancerâ€™s stable and weighted pools</strong>, and a few others. The remaining pool types seemed negligible.</p>
<h3 class="anchor anchorWithStickyNavbar_m2y2" id="then-the-real-challenge-hit">Then the Real Challenge Hit<a href="#then-the-real-challenge-hit" class="hash-link" aria-label="Direct link to Then the Real Challenge Hit" title="Direct link to Then the Real Challenge Hit">â€‹</a></h3>
<p>The complexity came when I had to actually <strong>write the algorithm</strong> â€” and I had no clear direction. Neither the documentation nor any online resource offered much guidance.</p>
<p>An ideal solver algorithm would likely involve:</p>
<ul>
<li><strong>Graph theory</strong>, to identify optimal trade paths</li>
<li><strong>Game theory</strong>, to balance solver profitability with order competitiveness</li>
<li><strong>Mathematical modeling</strong>, to simulate off-chain liquidity movements</li>
<li>Handling <strong>limit orders</strong>, <strong>partial orders</strong>, and other edge cases</li>
</ul>
<p>In short, this problem is likely <strong>NP-complete</strong>, requiring advanced algorithms and a deep mathematical foundation. I had just thrown myself headfirst into the deep end of arbitrage complexity.</p>
<h2 class="anchor anchorWithStickyNavbar_m2y2" id="can-you-still-get-results-without-a-phd-team">Can You Still Get Results Without a PhD Team?<a href="#can-you-still-get-results-without-a-phd-team" class="hash-link" aria-label="Direct link to Can You Still Get Results Without a PhD Team?" title="Direct link to Can You Still Get Results Without a PhD Team?">â€‹</a></h2>
<p>Thatâ€™s the question I began asking myself. Is it possible to <strong>simplify the problem</strong> and/or <strong>reduce the level of competition</strong>? It was clear that I had no chance to compete with the big players, even after a few months of development.</p>
<p>One idea came to mind: target a <strong>newer blockchain</strong> â€” one thatâ€™s less mature in terms of ecosystem and developer tooling. That would mean less competition, and maybe a better learning ground.</p>
<h3 class="anchor anchorWithStickyNavbar_m2y2" id="enter-hyperevm">Enter HyperEVM<a href="#enter-hyperevm" class="hash-link" aria-label="Direct link to Enter HyperEVM" title="Direct link to Enter HyperEVM">â€‹</a></h3>
<p>My search led me to <strong>HyperEVM</strong>, a relatively new EVM-compatible blockchain developed by <a href="https://hyperliquid.gitbook.io/hyperliquid-docs" target="_blank" rel="noopener noreferrer"><strong>Hyperliquid</strong></a>. It felt like stepping into the Wild West.</p>
<p>Why <strong>HyperEVM</strong> was promising:</p>
<ul>
<li><strong>Low gas fees</strong></li>
<li><strong>Modest but exploitable trading volume</strong></li>
<li><strong>EVM compatibility</strong> (making integration much easier)</li>
<li><strong>Fewer active arbitrage bots</strong>, due to its early-stage ecosystem</li>
</ul>
<p>So I began roughing out a system that could serve as an arbitrage bot on this new chain. Iâ€™ll describe the different directions I explored to improve the botâ€™s profitability. I experimented as much as I could and tried to learn by doing, testing every idea that seemed viable.</p>
<h2 class="anchor anchorWithStickyNavbar_m2y2" id="the-adventure-begins">The Adventure Begins<a href="#the-adventure-begins" class="hash-link" aria-label="Direct link to The Adventure Begins" title="Direct link to The Adventure Begins">â€‹</a></h2>
<p>Choosing an EVM-compatible chain seemed like a great idea â€” in theory, it would allow me to port this system to any other EVM-compatible chain later on. In practice, though, things turned out to be more complicated due to protocols specificities.</p>
<h3 class="anchor anchorWithStickyNavbar_m2y2" id="the-first-proof-of-concept">The First Proof of Concept<a href="#the-first-proof-of-concept" class="hash-link" aria-label="Direct link to The First Proof of Concept" title="Direct link to The First Proof of Concept">â€‹</a></h3>
<p>To build my proof of concept (PoC), I needed a few key components:</p>
<ul>
<li>Fast access to on-chain data</li>
<li>Off-chain liquidity simulation for Uniswap-like pools</li>
<li>The ability to send on-chain transactions with protection against slippage</li>
</ul>
<p>I started with a <strong>QuickNode RPC</strong>, but quickly hit the 200 requests/sec limit. That capped me at monitoring roughly 30 pools during testing.</p>
<p>I integrated <a href="https://hyperswap.exchange/" target="_blank" rel="noopener noreferrer"><strong>Hyperswap</strong></a> and <a href="https://kittenswap.finance/" target="_blank" rel="noopener noreferrer"><strong>Kittenswap</strong></a>, the two most active DEXs on <strong>HyperEVM</strong>.</p>
<p>My first approach, somewhat naive, was to look for arbitrage loops that start and end with the same token. That way, there&#x27;s no need to rely on price approximations (e.g., A â†’ B â†’ A or A â†’ B â†’ C â†’ A). I deployed a smart contract capable of executing multiple swaps and reverting if the final balance was lower than the initial one. This ensure that the bot will never spend more than it earns.</p>
<div class="language-solidity codeBlockContainer_AfQF theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_oi8h"><pre tabindex="0" class="prism-code language-solidity codeBlock_o8hW thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_kW6b"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">execute</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Trade</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">calldata</span><span class="token plain"> trades</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin">uint256</span><span class="token plain"> amountIn</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin">address</span><span class="token plain"> startToken</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">external</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">payable</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">returns</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">uint256</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin">uint256</span><span class="token plain"> balanceBefore </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">IERC20</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">startToken</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">balanceOf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">address</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ... perform trades ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin">uint256</span><span class="token plain"> balanceAfter </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">IERC20</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">startToken</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">balanceOf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">address</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// This line will revert all the previous operations and stop the execution</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">balanceAfter </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> balanceBefore</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Arbitrage failed&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> balanceAfter </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> balanceBefore</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p>In TypeScript, I implemented functions to compute expected token outputs for Uniswap V2 and approximated Uniswap V3 swaps â€” V3 is more complex due to its tick system while V2 is pretty straightforward.</p>
<p>To detect arbitrage opportunities, I wrote a simple brute force algorithm that computes the best arbitrage path for a given input amount.</p>
<p>I decided to hardcode the input amount to 1 HYPE, and to ignore the gas cost of the transaction because it was extremely low at the time.</p>
<h3 class="anchor anchorWithStickyNavbar_m2y2" id="the-first-result">The First Result<a href="#the-first-result" class="hash-link" aria-label="Direct link to The First Result" title="Direct link to The First Result">â€‹</a></h3>
<p>With everything wired up, I ran the bot, stepped away for 20 minutesâ€¦ and came back to see my <strong>first profitable transaction â€” about $0.30</strong> at the time.</p>
<p><img decoding="async" loading="lazy" alt="First Arbitrage Transaction" src="/clementjuventin-blog/assets/images/first_arbitrage_tx-aa70217d82235c8f8c691c195681ce52.jpg" width="1038" height="237" class="img_Gz92"></p>
<blockquote>
<p>My first arbitrage transaction on HyperEVM. Source <a href="https://purrsec.com" target="_blank" rel="noopener noreferrer">Purrsec</a>.</p>
</blockquote>
<p>It was a small gain, but a huge morale boost. At that point, I believed I was close to a viable system. With a dedicated node and estimated infrastructure costs around $100/month, profitability seemed achievable.</p>
<p><strong>Spoiler</strong>: I still had a long road ahead. Competition would ramp up quickly in the days to come. But in hindsight, that initial optimism was crucial â€” if I had only focused on the months of work and potential financial losses ahead, I might have stopped right there.</p>
<h2 class="anchor anchorWithStickyNavbar_m2y2" id="moving-toward-production">Moving Toward Production<a href="#moving-toward-production" class="hash-link" aria-label="Direct link to Moving Toward Production" title="Direct link to Moving Toward Production">â€‹</a></h2>
<p>So far, here&#x27;s a diagram of my architecture â€” each module is explained below.</p>
<p><img decoding="async" loading="lazy" alt="Architecture" src="/clementjuventin-blog/assets/images/arbitrager_archi-6bd40f6f2dbd597645e6e6a2a3bef9c4.png" width="1167" height="598" class="img_Gz92"></p>
<blockquote>
<p>Colors are just here to make things prettier ðŸ‘Œâ€‹.</p>
</blockquote>
<h3 class="anchor anchorWithStickyNavbar_m2y2" id="hyperevm-custom-node">HyperEVM Custom Node<a href="#hyperevm-custom-node" class="hash-link" aria-label="Direct link to HyperEVM Custom Node" title="Direct link to HyperEVM Custom Node">â€‹</a></h3>
<p>My first step toward production was setting up <strong>a local node</strong>. This gave me full on-chain access with low latency and no rate limits. I didn&#x27;t follow the advice from the documentation, which recommended using a node in Japan to reduce latency issues, even though it was cheaper in the US. I eventually switched and ended up losing several days syncing the node with a machine in Tokyo due to latency issues.</p>
<h3 class="anchor anchorWithStickyNavbar_m2y2" id="cold-data-indexer">Cold data Indexer<a href="#cold-data-indexer" class="hash-link" aria-label="Direct link to Cold data Indexer" title="Direct link to Cold data Indexer">â€‹</a></h3>
<p>I needed a way to cache persistent data (e.g., token names, decimals, pool tokens). So I wrote an <strong>indexer that stores data in Redis</strong>, refreshed periodically.</p>
<h3 class="anchor anchorWithStickyNavbar_m2y2" id="solvers">Solvers<a href="#solvers" class="hash-link" aria-label="Direct link to Solvers" title="Direct link to Solvers">â€‹</a></h3>
<p>Each solver receives a request from the driver and solves a graph to find arbitrage paths. Initially, this logic was in <strong>JavaScript</strong> for rapid prototyping. Later, I migrated to <strong>C++</strong>, which was 80x faster on average â€” crucial when tracking many pools. It is the same brute force algorithm I used in the PoC.</p>
<div class="language-cpp codeBlockContainer_AfQF theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_oi8h"><pre tabindex="0" class="prism-code language-cpp codeBlock_o8hW thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_kW6b"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">inline</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">find_best_arbitrage_cycle</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">vector</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">vector</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> Api</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">LiquidityPoolTradePath </span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">all_cycles</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> Api</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">uint256 amount_in</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Api</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">uint256 </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">best_amount_out</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">vector</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> Api</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">LiquidityPoolTradePath </span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">best_cycle</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">auto</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">cycle </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> all_cycles</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">try</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> Api</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">uint256 amount_out </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">compute_cycle_amount_out</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cycle</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> amount_in</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">amount_out </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> best_amount_out</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        best_amount_out </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> amount_out</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        best_cycle </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> cycle</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Math</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">InvalidLiquidityStateError </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">e</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">continue</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">exception </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">e</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">cout </span><span class="token operator" style="color:#393A34">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Error: &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;&lt;</span><span class="token plain"> e</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">what</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;&lt;</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">endl</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p>Note that I was heavily inspired by CowSwap. It was important for me to design the system with multiple solvers from the start, as this would allow for horizontal scaling of the solving process, as well as safe comparison of different algorithms â€” since each solution is evaluated and put in competition with the others.</p>
<h3 class="anchor anchorWithStickyNavbar_m2y2" id="monitoring">Monitoring<a href="#monitoring" class="hash-link" aria-label="Direct link to Monitoring" title="Direct link to Monitoring">â€‹</a></h3>
<p>To monitor performance, I built a metrics indexer that feeds <strong>Prometheus</strong>, which powers <strong>Grafana</strong> dashboards.</p>
<p>To be honest, I under-invested here. I&#x27;m still missing key insights and canâ€™t precisely track profit/loss over time. The idea was to compare strategies and versions of the arbitrage engine, but Iâ€™ve mostly been busy building essential features.</p>
<p>You can see in the following screenshot that this allows me to visualize the increase in the contract&#x27;s balances (due to arbitrage activity) and the amount of HYPE available to cover transaction fees for the wallets responsible for calling the arbitrageur.</p>
<p><img decoding="async" loading="lazy" alt="Grafana dashboard" src="/clementjuventin-blog/assets/images/arbitrager_dashboard-1a12f4d1c7a4d4161f3be43d77919c3d.png" width="1098" height="763" class="img_Gz92"></p>
<blockquote>
<p>Grafana dashboard (with a bug regarding BTC decimals).</p>
</blockquote>
<h3 class="anchor anchorWithStickyNavbar_m2y2" id="driver">Driver<a href="#driver" class="hash-link" aria-label="Direct link to Driver" title="Direct link to Driver">â€‹</a></h3>
<p>I built a central coordination module called the <strong>Driver</strong> (also inspired by CowSwapâ€™s architecture). Itâ€™s responsible for:</p>
<ul>
<li>High-frequency data collection</li>
<li>Structuring the data into a standard request format</li>
<li>Sending requests to all available solvers</li>
<li>Collecting and evaluating responses within a strict timeout</li>
<li>Comparing the results to determine the best solver and submit the transaction</li>
</ul>
<p>Simulating gas cost and submitting transactions reliably was another challenge. I eventually introduced a dynamic fee deduction, setting aside a portion of profit to cover validator fees and ensure transaction inclusion. I am still not convinced with this approach, but I have no better idea for now.</p>
<p>Thanks to the strategy of using multiple solvers, I was able to narrow down the list of cryptocurrencies used to initiate arbitrage cycles. This increases the number of opportunities, as it allows for shorter arbitrage loops.</p>
<p>For example, a cycle like A â†’ B â†’ C â†’ B â†’ A can be shortened to B â†’ C â†’ B, saving two transactions if the contract already holds B.</p>
<p>Responses are evaluated and filtered â€” in the PoC, I hardcoded the input token amount to 1 HYPE, which was suboptimal. Profits vary significantly depending on input size.</p>
<p>To omptimize the input size estimation, I tried different strategies:</p>
<h4 class="anchor anchorWithStickyNavbar_m2y2" id="offchain-computation">Offchain computation<a href="#offchain-computation" class="hash-link" aria-label="Direct link to Offchain computation" title="Direct link to Offchain computation">â€‹</a></h4>
<p>Off-chain calculation is fast and reliable â€” if you have accurate models and complete data. For Uniswap V2, the math is simple. For V3, itâ€™s <a href="https://uniswapv3book.com/index.html" target="_blank" rel="noopener noreferrer"><strong>evil</strong></a>.</p>
<p>In the PoC, I used a rough approximation to avoid tick-level math. To compute real outputs with Uniswap V3&#x27;s SDK, you need <strong>all tick data</strong>, which is extremely resource-intensive â€” even with a private node.</p>
<p>My idea was to fetch a subset of ticks because arbitrage transactions are often low-volume. I managed to code the math but the delays were still significant when it came to fetch the data. I finally gave up this approach for the next strategy.</p>
<h4 class="anchor anchorWithStickyNavbar_m2y2" id="onchain-computation">Onchain computation<a href="#onchain-computation" class="hash-link" aria-label="Direct link to Onchain computation" title="Direct link to Onchain computation">â€‹</a></h4>
<p>Instead of fully computing everything off-chain, I opted for a hybrid approach:</p>
<ul>
<li>Approximate swaps using a constant-tick assumption (ie. Uniswap V3 math approximation)</li>
<li>Collect all promising trade paths</li>
<li>Simulate each candidate on-chain via a custom smart contract (a read-only call)</li>
<li>Use binary search (dichotomy) to find the input amount that maximizes profit</li>
</ul>
<p>This approach is based on the fact that the data is available, but communication between the driver and the node results in significant latency. Even when both programs run on the same machine, each request still has to go through the full network stack. Since tick retrieval can&#x27;t be properly parallelized, fetch times become a bottleneck.</p>
<p>Instead, the node is tasked with simulating a smart contract execution. This way, it uses the same math as the actual contracts (eliminating the risk of errors) and has direct, optimized access to its own data.</p>
<p>This gave me much better results while avoiding heavy off-chain computation. Here is a snippet of the binary search function, it returns the optimal <code>k</code> value (ie. the best amount) to maximize the profit:</p>
<div class="language-solidity codeBlockContainer_AfQF theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_oi8h"><pre tabindex="0" class="prism-code language-solidity codeBlock_o8hW thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_kW6b"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">binarySearchOptimalK</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Trade</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">calldata</span><span class="token plain"> trades</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin">uint256</span><span class="token plain"> step</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin">uint256</span><span class="token plain"> balance</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">internal</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">returns</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">uint256</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin">uint256</span><span class="token plain"> low_k </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin">uint256</span><span class="token plain"> high_k </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> balance </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> step</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">low_k </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> high_k</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token builtin">uint256</span><span class="token plain"> mid_k </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> low_k </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">high_k </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> low_k</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token builtin">uint256</span><span class="token plain"> profitMid </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">computeTradesProfit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            trades</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            mid_k </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> step</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token builtin">uint256</span><span class="token plain"> profitNext </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">computeTradesProfit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            trades</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mid_k </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> step</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">profitMid </span><span class="token operator" style="color:#393A34">&gt;=</span><span class="token plain"> profitNext</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            high_k </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> mid_k</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            low_k </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> mid_k </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> low_k</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p>And this is <strong>costless</strong> because I am <strong>simulating</strong> this call (even though it&#x27;s a write function).</p>
<h3 class="anchor anchorWithStickyNavbar_m2y2" id="smart-contract-module">Smart Contract Module<a href="#smart-contract-module" class="hash-link" aria-label="Direct link to Smart Contract Module" title="Direct link to Smart Contract Module">â€‹</a></h3>
<p>My first smart contract was simple, and it worked well initially.
The main purpose is to prevent the bot to concretely loose funds (e.g. Spend 1 A and obtain 0.98 A).</p>
<p>But as my whole bot system matured, it became clear that the contract was <strong>critical to profitability</strong>.</p>
<p>Profit calculation is straightforward: <code>profit = total_output - total_input - gas_cost</code>.</p>
<p>But when a transaction fails, you still pay the gas â€” often due to a competing bot front-running your trade.
These failed transactions became increasingly costly due to the gas price increasing of a ~500x factor (HyperEVM became more popular).</p>
<p><img decoding="async" loading="lazy" alt="HyperEVM daily transactions" src="/clementjuventin-blog/assets/images/hyperevm_daily_tx-ab99180f9688d4016c4f006371b2d2e3.png" width="934" height="562" class="img_Gz92"></p>
<blockquote>
<p>HyperEVM daily transactions. Source <a href="https://purrsec.com/trending/metrics" target="_blank" rel="noopener noreferrer">Purrsec</a>.</p>
</blockquote>
<p>To mitigate this:</p>
<ul>
<li>I optimized gas usage with basic Solidity gas optimizations</li>
<li>Introduced an early-exit condition before the final balance comparison (<code>balanceAfter &lt; balanceBefore</code>)</li>
<li>Tweaked execution to minimize unnecessary operations</li>
</ul>
<p>This lowered the average cost per trade significantly, but not enough.</p>
<h2 class="anchor anchorWithStickyNavbar_m2y2" id="current-results--next-steps">Current Results &amp; Next Steps<a href="#current-results--next-steps" class="hash-link" aria-label="Direct link to Current Results &amp; Next Steps" title="Direct link to Current Results &amp; Next Steps">â€‹</a></h2>
<p>As of now, the bot is not yet profitable. On average, I recover only ~80% of the input.</p>
<p>To bridge the gap to profitability, I have two main ideas:</p>
<ul>
<li>Reduce fees further</li>
<li>Use heuristics to detect and avoid unprofitable trades</li>
</ul>
<p>The second option seems most promising â€” I havenâ€™t explored it yet, and it requires a larger dataset to analyze trade outcomes at scale. I&#x27;ll need to analyze all trades performed and hopefully find patterns that reduce the number of failed transactions.</p>
<p>Also, I face a new challenge: <strong>latency</strong>.</p>
<p>Block time on HyperEVM has dropped to under 1 second (2 seconds originally). Because my experiments run from a machine in US, network latency to the HyperEvm sequencers (hosted in Tokyo) is hurting my competitiveness.</p>
<p>Iâ€™ll need a new setup â€” ideally a server located closer to the sequencer region â€” to reduce latency and stay in sync.</p>
<h2 class="anchor anchorWithStickyNavbar_m2y2" id="final-thoughts">Final Thoughts<a href="#final-thoughts" class="hash-link" aria-label="Direct link to Final Thoughts" title="Direct link to Final Thoughts">â€‹</a></h2>
<p>Thereâ€™s still a long road ahead, but I believe itâ€™s worth it. Iâ€™ve learned a ton about arbitrage, on-chain mechanics, and smart contract optimization â€” and Iâ€™m only getting started.</p></div><footer class="docusaurus-mt-lg"><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><b>Tags:</b><ul class="tags_aLRf padding--none margin-left--sm"><li class="tag_MC4v"><a rel="tag" title="Web3 related projects" class="tag_PxKz tagRegular_ozuG" href="/clementjuventin-blog/tags/web3">Web3</a></li><li class="tag_MC4v"><a rel="tag" title="Story about my life" class="tag_PxKz tagRegular_ozuG" href="/clementjuventin-blog/tags/story">Story</a></li><li class="tag_MC4v"><a rel="tag" title="Technical articles" class="tag_PxKz tagRegular_ozuG" href="/clementjuventin-blog/tags/technical">Technical</a></li></ul></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--next" href="/clementjuventin-blog/degen-to-sniper"><div class="pagination-nav__sublabel">Older post</div><div class="pagination-nav__label">From A Nooby Degen to a Bloodthirsty Sniper</div></a></nav></main><div class="col col--2"><div class="tableOfContents_g27u thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#what-is-mev" class="table-of-contents__link toc-highlight">What is MEV?</a></li><li><a href="#starting-with-the-basics" class="table-of-contents__link toc-highlight">Starting with the Basics</a><ul><li><a href="#then-the-real-challenge-hit" class="table-of-contents__link toc-highlight">Then the Real Challenge Hit</a></li></ul></li><li><a href="#can-you-still-get-results-without-a-phd-team" class="table-of-contents__link toc-highlight">Can You Still Get Results Without a PhD Team?</a><ul><li><a href="#enter-hyperevm" class="table-of-contents__link toc-highlight">Enter HyperEVM</a></li></ul></li><li><a href="#the-adventure-begins" class="table-of-contents__link toc-highlight">The Adventure Begins</a><ul><li><a href="#the-first-proof-of-concept" class="table-of-contents__link toc-highlight">The First Proof of Concept</a></li><li><a href="#the-first-result" class="table-of-contents__link toc-highlight">The First Result</a></li></ul></li><li><a href="#moving-toward-production" class="table-of-contents__link toc-highlight">Moving Toward Production</a><ul><li><a href="#hyperevm-custom-node" class="table-of-contents__link toc-highlight">HyperEVM Custom Node</a></li><li><a href="#cold-data-indexer" class="table-of-contents__link toc-highlight">Cold data Indexer</a></li><li><a href="#solvers" class="table-of-contents__link toc-highlight">Solvers</a></li><li><a href="#monitoring" class="table-of-contents__link toc-highlight">Monitoring</a></li><li><a href="#driver" class="table-of-contents__link toc-highlight">Driver</a></li><li><a href="#smart-contract-module" class="table-of-contents__link toc-highlight">Smart Contract Module</a></li></ul></li><li><a href="#current-results--next-steps" class="table-of-contents__link toc-highlight">Current Results &amp; Next Steps</a></li><li><a href="#final-thoughts" class="table-of-contents__link toc-highlight">Final Thoughts</a></li></ul></div></div></div></div></div></div>
</body>
</html>